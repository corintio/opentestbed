import game.CashGameDescription;
import game.GameIDGenerator;
import game.GameRunner;
import game.HandHistoryWriter;
import game.RandomDeck;
import game.TableSeater;

import java.io.FileWriter;
import java.util.Arrays;

import bots.BotRepository;

/**
 * This class starts a simulation on the console and writes a handhistory-file
 * to the ./data directory
 */
public class CashGameConsoleStarter {
	public static void main(String[] args) throws Exception {
		BotRepository botRepository = new BotRepository();
		TableSeater tableSeater = new TableSeater(botRepository);
		GameIDGenerator gameIDGenerator = new GameIDGenerator(System.nanoTime());
		HandHistoryWriter handHistoryWriter = new HandHistoryWriter();
		handHistoryWriter.setWriter(new FileWriter("./data/history" + System.nanoTime() + ".txt"));
		
		// created via GUI, persisted via XML to the ./data/games dir in the future
		CashGameDescription cashGameDescription = new CashGameDescription();
		cashGameDescription.setSmallBlind(0.01);
		cashGameDescription.setBigBlind(0.02);
		// four CallBots fight against each other
		// valid BotNames can be obtained from the botRepository
		cashGameDescription.setBotNames(new String[] { "DemoBot/AlwaysCallBot", "DemoBot/AlwaysCallBot", "DemoBot/AlwaysCallBot", "DemoBot/AlwaysCallBot" });
		cashGameDescription.setInGameNames(new String[] { "Cally #1", "Cally #2", "Cally #3", "Cally #4" });

		// Stack-handling
		cashGameDescription.setInitialBankRoll(2);
		cashGameDescription.setMinStackBeforeRebuy(0.50);
		cashGameDescription.setRebuyAmount(1.50);

		cashGameDescription.setNumGames(2000);

		// start the game
		GameRunner runner = cashGameDescription.createGameRunner();
		runner.runGame(new RandomDeck(), tableSeater, gameIDGenerator, Arrays.asList(handHistoryWriter));


	}
}
